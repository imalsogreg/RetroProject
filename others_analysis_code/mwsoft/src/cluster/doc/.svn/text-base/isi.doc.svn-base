
PROGRAM:
    isi

DESCRIPTION:
    Computes a variety of interval-based histograms such as
    auto and crosscorrelations, peth, isi, logisi, and rate.

AUTHOR:
    Written by Matthew Wilson
    ARL Division of Neural Systems, Memory, and Aging
    University of Arizona
    Tucson, AZ 85724
    wilson@nsma.arizona.edu

DATES:
    original 5/91
    program update 9/91
    documentation update 11/91


USAGE:
    isi tfile [tfile2] [-o file] 
	[-isi] [-corr] [-rate] [-int] [-sparse]
	[-logtime] [-bin msec] [-tmax msec]
        [-norm1] [-norm2] [-v]

OPTIONS:
    Note that spaces between options and arguments are important.
    Order of the arguments is not important. All arguments and options
    must be placed on a single line (no carriage returns).

INPUT FILE OPTIONS:
    tfile
    tfile2 
	These options specify time files, to be used as sources of spike times.
	For crossinterval calculations (only cross correlations are
	currently supported) a second time file can be specified.
	Note that the order of files is important and dictates master
	(first file) and slave (second file) data sets.

	DEFAULT: none. Required argument.

	TFILE FORMAT:
	The tfile is a binary file consisting of sequential unsigned
	long integers corresponding to the 4 byte timestamps
	maintained in the Brainwave(tm) uff files. A unit timestamp
	represents 100 usec.

OUTPUT FILE OPTIONS:
    The output files generated by specifying this option
    consist of ascii data which can be viewed using the 'xplot' program.

    -o file
	Specifies the file to which the output will be saved. 

	DEFAULT: output to stdout (the terminal).

    -sparse
	supresses output of zero-valued data points which can dramatically
	reduce output file size if the output data is only sparsely non-zero.
	Note that this does not affect any of the computations, it just
	minimizes output file size.

	DEFAULT: false

ANALYSIS OPTIONS:
    These options specify the type of analysis to be performed using the
    time files. Each are mutually exclusive.

    -isi
	specifies the calculation of the interspike interval 
	histogram and output is in the form of total number of intervals
	within a bin. The logarithmic interspike interval can be
	computed by additionally specifying the -logtime option
	(see below). With this option the bins are scaled logaritmically.
	Time is in units of msec for linearly scaled isi. For log scale
	it is in units of 10^n msec.

	DEFAULT: true

    -corr
	specifies the calculation of either autocorrelation (if only a
	single time file is given) or crosscorrelation (if two time
	files are given). If normalization is not specified (see -norm1,
	-norm2) then the output is in terms of the number of correlated 
	events (spikes) within a bin.

	DEFAULT: false

    -rate
	calculates the rate (spikes/sec) as a function of time (sec) by 
	summing the number of events which fall within a bin and dividing by
	bin size. The mean inverse log interval SUM(1/log(interval))/binsize 
	as a function of time can be computed by additionally specifying 
	the -logtime option (see below).

	DEFAULT: false

    -int
	calculates the instantaneous frequency (1/interval) or inverse
	log interval as a function of time. No binning is performed.

	DEFAULT: false

BINNING OPTIONS

    -logtime
	This option interacts with several of the analysis options
	to provide logarithm scaling to the binning dimension
	(see -isi, -rate, -int). 

	DEFAULT: false

    -tmax msec
	specifies the maximum time to be processed. For the -rate option
	this translates into the maximum amount of time from the
	beginning of the time data. For the -corr option this is the
	maximum +-interval of the histogram. For -isi this is the maximum
	interval binned (note for logisi tmax should be specified as the
	log of the max time)

	DEFAULT: entire data set

    -bin msec
	specifies the bin size in msec. This option affects the output
	generated by -corr, -rate, -isi. For -isi in combination with
	the -logtime option, the binsize is given in 10^n msec units, where
	n is the argument to the -bin option.
	e.g. a binsize of 1 would result in bins of 10,100,1000... msec

	DEFAULT: 1

    -norm1
	this option causes correlation histograms to be normalized by
	the number of events (spikes) from tfile 1 
	(first tfile specified on the command line).
	Specifying -norm1 and -norm2 together will normalize by the 
	product of the number of events from tfile 1 and tfile 2 thus
	resulting in correlation values (r) as the output.
	(SUM(t1*(t2-tau))/(n1*n2) binned over tau).

	DEFAULT: false

    -norm2
	this option causes correlation histograms to be normalized by
	the number of events (spikes) from tfile 2 
	(first tfile specified on the command line). See -norm1 for
	discussion of combining -norm1 and -norm2 options.

	DEFAULT: false

MISCELLANEOUS OPTIONS:
    -usage
	displays the list of available options.

    -version
	displays the version number of the program

    -v
	this option turns on verbose mode which will display more extensive
	status information during data processing.

	DEFAULT: not verbose

NOTES:

EXAMPLES:

    In each of these examples the output will be in the form of an ascii 
    data file which can be viewed with the 'xplot' program. 

    AUTOCORR
    Given spiketime data file 'tdata1' the auto correlation
    over a 200 msec interval with 1 msec bin size could be computed with 
    the following command:

	isi tdata1 -corr -bin 1 -tmax 200 -o acorr.out

    CROSSCORR
    Given spiketime data files 'tdata1' and 'tdata2' the cross correlation
    over a 200 msec interval with 1 msec bin size could be computed with 
    the following command:

	isi tdata1 tdata2 -corr -bin 1 -tmax 200 -o xcorr.out

    RATE vs TIME
    Given spike data file 'tdata1', average spike rate as a function of time 
    in 1 sec bins can be computed as follows

	isi tdata1 -rate -bin 1000 -o rate.out

    LOGINTERVAL vs TIME
    Given spike data file 'tdata1', average inverse log interval
    as a function of time in 1 sec bins can be computed as follows

	isi tdata1 -rate -logtime -bin 1000 -o logint.out

    ISI
    The interspike interval histogram for spike time data 'tdata1'
    with 10 msec bins and maximum interval of 1 sec can be computed using

	isi tdata1 -isi -bin 10 -tmax 1000 -o isi.out

    LOGISI
    log isi for intervals up to 1 sec (10^3 msec) with 10 intervals per log
    unit can be computed as follows

	isi tdata1 -isi -logtime -bin .1 -tmax 3 -o logisi.out

    PETH
    Given event time file 'tevent1' and spiketime file 'tdata1', the PETH
    for 200 msec can be computed as follows:

	isi tevent1 tdata1 -corr -norm1 -tmax 200 -o peth.out


