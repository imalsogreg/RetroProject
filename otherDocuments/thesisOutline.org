
\newpage

* Overview

Three chapters about populations of neurons in the hippocampus
coordinating their activity on fine timescales, and how that
coordination relates to the larger context of hippocampal inputs,
outputs, and experimental measurements. In the first chapter, explore
the lack of synchrony in timing of the brain rhythms underlying
excitatory drive in hippocampal place cells, and the impact of those
differences on the ability of distant place cells to coordinate reliably
during population-wide coding events. In the second chapter, describe
the development of a tool for detecting place cell population coding
events and using the information they contain to manipulate brain
activity or behavior experimentally. In the third chapter, describe the
unexpected transition of retrosplenial cortex into a slow-wave-sleep
like state during reward consumption, and the timing relationship
between hippocampal activity and retrosplenial cortex during these
events. Conclude with a discussion about coordinated encoding that ties
the three chapters together - how does the sequential nature of coding
in hippocampus relate to coding in the afferents and efferents - 
do they also encode information in spike sequences? What experiments 
using real-time ensemble decoding would help answer those questions?

\newpage

* General Background

** Hippocampal anatomy and physiology relevant to information coding

*** Hippocampal anatomy: cell layer and dendritic layer

The rat hippocampus is a curved, three-dimensional structure with anatomical features that do not align with the stereotactic coordinate frame. It is easier to describe after flattening, into a sheet with thickness. This sheet is the height of a single hippocampal pyramidal neuron, about 1mm, as hippocampal

*** Hippocampal laminar anatomy: CA1, CA3, entorhinal cortex; their connectivity
*** Hippocampal place cells
*** Theta oscillations and multiunit spike phase
*** Theta phase precession & theta sequences

** Sleep states, cortical rhythms, hippocampal-cortical interactions

*** Sleep stages, cortical EEG correlates (spindles, delta, theta)
*** Up-down states in vitro, frames of cortical spikes during sleep in vivo
*** Hippocampal ripples and sleep replay, wake replay
*** Hippocampal-cortical coordination of ripples/spindles
*** Spatial content in CA1 and visual cortex


** Haskell

*** What is functional programming
*** What are types
*** Avoiding bugs by lifting program logic into types, compiler catches mistakes early
*** Avoiding bugs through declarative programming
*** Concurrency - difficulty of running multiple threads simultaneously
*** Software transactional memory


\newpage

* Coordinated information coding in a desynchronized network

** Introduction

*** CA1 place cell excitation is timed by 10Hz oscillation - theta rhythm
*** Tension between hypothesized roles in gating communication channels and encoding
*** Theta as traveling wave, excitatory time offsets over hippocampal CA1
*** Theta-dependent phenomena: locally modulated or globally synchronized?
*** Theta sequences: locally paced or globally synchronized?

** Results

*** Theta phase spatial properties and timing offsets: 20ms delay per mm

-  Theta oscillation recorded from LFP, phase offsets correlated w/
   medial-lateral electrode location
-  Describe traveling-wave model fit to multi-tetrode array phase offset
   pattern
-  Repeat above using multiunit spiking as the measure of theta rhythm,
   comparison to findings with LFP
-  From traveling wave parameters, estimate the timing offset per unit
   anatomical distance in CA1 (20 ms/mm)
 
*** Ensemble theta sequences are synchronized

-  Subdivide tetrodes according to anatomical location, three groups 1mm
   wide
-  Decode position independently in each group at fine timescale
-  Theta sequences in most medial group line up with those in most
   lateral group to better within 10 ms (expected 40 ms if timing
   follows theta verbatim)

*** Place cell pairs synchronize across long distances

-  Considering the distance between two tuning curves (e.g. 0 meters)
   and the anatomical distance between the two place cells (e.g. 1 mm),
   what is the observed timing difference between their spikes?
-  Repeat for all pairs of place cells, measure timing offset as a
   function of place field distance and anatomical distance
-  Measured 15 ms per environmental meter (expected from theta
   sequences)
-  Measure ~3 ms per anatomical mm (lower than predicted from theta time
   offsets)

*** Place field properties correlate weakly with anatomical location

-  Lateral CA1 units tend to be longer
-  No significant correlation between anatomical location and field
   skewness

*** Theta sequences and place cell pairs are synchronized between CA3 and CA1


-  Repeat theta-sequence timing and place-cell pair timing, but
   comparing CA3 to CA1
-  Observe that CA3 and CA1 theta sequences are tightly synchronized,
   despite literature theta timing differences ~25 ms.

** Discussion

*** Theta traveling wave matches previous report: ~20ms/mm delay
*** Despite theta timing differences, information coding is synchronized
*** Different parts of CA1 weakly preferentially carry most of the spike rate at different times 

*** Model 1: Spatially graded, temporally constant compensating excitation

   -  Predictions for place field size match data
   -  Prediction for skewness don't

*** Model 2: Phase precession inherited from synchronized afferents

    - Afferents don't have traveling waves, but CA3 (main input 1)
      is uniformly different phase from entorhinal cortex (main input 2),
      and CA1 phase is inherited from a mixture of these two, according to
      the proportional strength of the inputs at that point. Medial CA1
      gets more heavy EC input and is excited earlier , lateral CA1 more
      heavy CA3 input and is excited later. Phase precessing from
      individual CA1 cells is inherited directly from one input area or the
      other.

   -  Possibly more parsimonious than graded excitation model
   -  Requires CA1 phase to be between CA3 and EC phases, but this isn't
      the case

-  Limitations of this study

   -  Too few units, had to collapse data over time, or average over
      cells
   -  Not sensitive to cycle-by-cycle variations in theta wave
      parameters.

-  New questions

   -  Is theta desynchronized, traveling, within CA3, EC, others?
   -  Which model (1,2, or another) accounts for greater synchrony in
      information content than in underlying excitation?
   -  EC layer 3 grid cells do not phase precess. Do they contribute to
      CA1 timing?
   -  'Medial' and 'lateral' CA1 carry preferentially early and late
      stages of theta sequences, but we only looked at the most medial
      1/3 of CA1 - does this trend continue as you proceed laterally,
      with very lateral place cells prospectively coding far ahead of
      the rat?
   -  'Traveling wave' model often a poor fit to individual cycles. Can
      larger grids of electrodes find a more accurate structure, more
      whole picture
   -  Is the synchrony of place cell coding used downstream? Actively
      maintained in CA1?

\pagebreak

*** Information timing decoupled from bulk firing rate for globally coherent coding
* Real time position decoding from populations of place cells

** Introduction

*** Theta sequences and sequence replay in place cells, phenomenology

   -  Replay occurs during reward consumption & slow-wave sleep
   -  Theta sequences always present during running
   -  Both theta sequences and replay touch parts of the track in a way
      that isn't strictly tied to recency of experience or future goals
   -  However there is a statistical bias during sleep for replay of
      maze experienced just prior to sleep, and statistical bias for
      awake replay to involve salient parts of a maze (start/reward
      location)

*** Summary of semi-indiscriminant replay disruption studies

   -  Disruption of all ripples in sleep slows learning of the more
      recently experienced track.
   -  Disruption of all awake ripples in a working memory task
      interferes with decisions involving working memory, doesn't
      measurably interfere with simpler decisions

*** Rationale for information-dependent replay manipulation

   -  Is replay content in any way under rat's control?

      -  Reward rat for replays that go West, punish for replays that go
         East
      -  Do West-going replays then happen more often?

   -  Are rats aware of their replay content?

      -  Use most recent replay (West or East) to determine which arm of
         a maze will be rewarded
      -  Can rat learn to use their own replay (or its correlates) to
         guide their behavior?

*** Online replay decoding challenges

   -  Tracking rat, isolating units, computing place fields, and
      stimulus decoding all happen offline; need to happen online for
      streaming data
   -  /Throughput requirements:/ must decode at least as quickly as data
      comes in
   -  /Latency requirements:/ data -> decoding lag must be fast enough
      for behavioral feedback, preferably fast enough to disrupt an
      ongoing replay
   -  /Asymptotic requirements:/ Decoding time must not increase with
      duration of experiment, or long experiments ruled out.
   -  /Concurrency:/ Many sources of data (32 tetrodes, tracker, user
      input) all updating a single model

*** Minimizing human intervention: no time for manual spike sorting

*** Choosing the right language for implementation: Haskell

   -  Haskell types model domain very tightly, compiler checks program
      logic
   -  Types let compiler check whole codebase during code rewrites /
      code experiments
   -  Types tell runtime system which operations are pure
      (not-interacting), very nice property for concurrency



** Materials and Methods

*** Backend signal acquisition and networking

-  Compatible with existing recording system, runs side by side with
   shared timestamps
-  NiDAQ cards, 64 channels at 32 kHz
-  Software spike filtering, software LFP filtering
-  Software grouping of channels into tetrodes, spike detection
-  Publish spikes and LFP to the network for other programs to process

*** Offline position reconstruction

-  Manually sort spikes from many cells on single tetrode into groups,
   recover single-cell spike trains
-  Turn rat location on curved track into simple stimulus for prediction

   -  Distance along track
   -  'Outbound' or 'inbound' running direction

-  Compute likelihood of spike rate given stimulus, using data from
   whole session
-  For a given ~15ms time window, use spikes in that time window and
   matching spike rate likelihood functions (place fields) to predict
   stimulus (track pos) by Bayesian inference

*** Online position reconstruction

-  Manual spike sorting probably far too slow, use semi-automated or
   clusterless
-  Choosing data structure for spike sorting & decoding with bounded
   memory & time use
-  Likelihood functions have to be updated during experiment

   -  By a lot of threads (~ 32 tetrodes * spike rate, plus current
      position)
   -  Decoder also writes to likelihood function

-  Use Haskell's concurrency library to coordinate many writing/reading
   threads

** Results

*** Decoding quality: theta sequences and replay

   -  Offline position reconstruction compared to online with clusters,
      online clusterless
   -  Tracking of rat's position
   -  Appearance of theta sequences
   -  Appearance of replay

*** Decoding speed and realtime requeriments
*** Bugs, deadlocks, crashes and refactorings

** Discussion

*** Recap: designed tool for decoding streaming place cell data
*** Remaining components needed to run experiments

   -  Networked rat tracker and track linearizer
   -  Online line-finding algorithm
   -  Combining estimates from multiple computers (for > 16 tetrode
      case)
*** Experimental goals with sequence replay
*** Extension to non-hippocampal contexts

\pagebreak

* Retrosplenial slow-wave wake and interaction with hippocampus

** Introduction

*** Cortico-hippocampal sleep interactions, possible role in memory

-  Two phase consolidation model: encode at wake, burn-in during sleep
-  HPC ripples correlated w/ sleep CTX sleep spindles - communication
   signature?
-  Regular interval between hippocampal frame onset and cortical frame
   onset

*** Slow wave oscillations cleanly destinguish between sleeping and awake cortex
*** Ripples cleanly destinguish between 'online' and 'offline' hippocampus
*** Retrosplenial cortex unexpectedly follows HPC into SWS-like state during reward

** Results

*** Characterizing slow-wave sleep (SWS) in cortex

-  Examples of light sleep, spindles, frames and K-complexes in LFP,
   spiking
-  Examples of deep sleep, frames and K-complexes in LFP, spiking
-  Distribution of activity over all cortical electrodes
-  Average up-state length, down-state length

*** Retrosplenial cortex enters SWS-like state during novelty / large rewards

-  Examples
-  Average up-state length, down-state length

*** RSC awake slow waves coordinate with hippocampal ripples

-  5-second window showing co-transition into SWS-like state (RSC
   frames, HPC ripples & replay)
-  200-second window showing behavioral-timescale relationship
-  Cross-correlation of ripples & RSC frames similar between wake and
   SWS

*** RSC awake slow waves require large reward in well-trained rats

-  Occur at most stopping points early in training
-  After ~1 week, spontaneous frames & small-reward frames stop, but
   large-reward frames persist (for at least a month)

*** Anatomical restriction - nonparticipation in other cortical areas

-  Simultaneously recorded somatosensory, motor, posterior parietal
   cortex have no frame-like activity (noticeable changes in spike rate
   or LFP) during RSC awake frames

*** Slow-wave wake not limited to times of sleepiness

-  Awake SWS-like activity continues in both light and dark phases of
   light cycle
-  Many SW's are flanked by fast running and chewing

** Discussion

*** Recap: Awake slow-waves in RSC, coordinated with HPC, fully awake
*** In HPC-Cortex interaction, Online/offline vs. awake/asleep
*** Functional roles for HPC-Cortex coordination may apply to wake
*** New questions raised by SWW: mechanism and function

-  New questions:

   -  What other brain areas have SWWake? Papez circuit?
   -  What's the mechanism for the switch from awake-aroused to SWW
      cortex?
   -  What causes Slow Waves to traverse all of cortex during sleep, and
      not wake?
   -  Is there information content in slow-wave frame spikes? Is it
      bounded by slow wave boundaries in an interesting way?

\pagebreak

** Materials & Methods

-  10 tetrodes in HPC, 10 tetrodes split between retrosplenial,
   somatosensory, motor, posterior parietal cortex
-  Trained rats to run circular track for reward every 270 degrees CCW

\newpage

* Conclusion / Wrap-up

Brief summary of the role of populations of neurons in hippocampal
spatial coding. Much more reliability in the timing of place cell spike
sequences than there is in single cell measures like phase precession.
We want to know if population sequences are an essential feature of
coding, or just a means of denoising, and answering that question will
involve manipulations that account for information content in and react
to it in real time, as well as studies of how population sequences are
interpreted by downstream cortical areas.
